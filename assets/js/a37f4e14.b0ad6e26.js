"use strict";(globalThis.webpackChunkawesome_ha_blueprints_website=globalThis.webpackChunkawesome_ha_blueprints_website||[]).push([[898],{2710:(t,e,o)=>{o.r(e),o.d(e,{default:()=>K});var l=o(3303),r=o(1153),n=o(6285),i=o(4538),a=o(162),s=o(656),d=o(351),p=o(6605),c=o(9441),x=o(2782),g=o(7342),h=o(2941),y=o(2454),u=o(7263),m=o(50),b=o(1929),f=o(1778),j=o(7711);const w="#4f46e5",_="#10b981",k="#111827",S="#1f2937",v="#f9fafb",D="#9ca3af",B="#374151",C="#1f2937",z="#111827",L="#6366f1",A=t=>t.toLocaleString(),T=({active:t,payload:e})=>{if(t&&e&&e.length){const t=e[0].payload;return(0,j.jsxs)("div",{style:{backgroundColor:S,padding:"8px",border:`1px solid ${B}`,borderRadius:"4px",color:v,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:[(0,j.jsxs)("p",{style:{margin:0,fontWeight:"bold"},children:[t.name," Downloads"]}),(0,j.jsxs)("p",{style:{margin:0},children:["Total: ",A(t.value)," (",t.percent.toFixed(1),"%)"]})]})}return null},$=({active:t,payload:e})=>{if(t&&e&&e.length){const t=e[0].payload;return(0,j.jsxs)("div",{style:{backgroundColor:S,padding:"8px",border:`1px solid ${B}`,borderRadius:"4px",color:v,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:[(0,j.jsx)("p",{style:{margin:0,fontWeight:"bold"},children:t.name}),(0,j.jsxs)("p",{style:{margin:0},children:["Downloads: ",A(t.Downloads)]})]})}return null},W=({columnKey:t,title:e,currentSort:o,onSort:l,style:r})=>{const n=o.key===t,i="ascending"===o.direction;return(0,j.jsx)("th",{onClick:()=>l(t),style:{...r,cursor:"pointer",padding:"12px 16px",textAlign:r.textAlign||"left",fontSize:"12px",fontWeight:"600",color:D,borderBottom:`2px solid ${B}`,textTransform:"uppercase",overflow:"hidden",textOverflow:"ellipsis"},children:(0,j.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"right"===r.textAlign?"flex-end":"flex-start"},children:[e,n&&(0,j.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 320 512",style:{marginLeft:"4px",width:"10px",fill:i?_:w,transform:i?"rotate(180deg)":"none",transition:"transform 0.2s"},children:(0,j.jsx)("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L128 205.3V448c0 17.7 14.3 32 32 32s32-14.3 32-32V205.3l73.4 73.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-128-128z"})}),!n&&(0,j.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 320 512",style:{marginLeft:"4px",width:"10px",fill:D,opacity:.5},children:(0,j.jsx)("path",{d:"M41 288h238c21.4 0 32.1 25.8 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41zm255-105L177 64c-9.4-9.4-24.6-9.4-33.9 0L24 183c-15.1 15.1-4.4 41 17 41h238c21.4 0 32.1-25.8 17-41z"})})]})})},M=({data:t})=>{const[e,o]=(0,l.useState)({key:"total",direction:"descending"}),r=(0,l.useMemo)(()=>{const o=[...t];return e.key&&o.sort((t,o)=>{let l,r;return"total"===e.key?(l=parseInt(t.total,10),r=parseInt(o.total,10)):"last_downloaded"===e.key?(l=t.last_downloaded?Date.parse(t.last_downloaded):0,r=o.last_downloaded?Date.parse(o.last_downloaded):0):(l=t[e.key],r=o[e.key]),l<r?"ascending"===e.direction?-1:1:l>r?"ascending"===e.direction?1:-1:0}),o},[t,e]),n=t=>{let l="descending";e.key===t&&"descending"===e.direction&&(l="ascending"),o({key:t,direction:l})};return(0,j.jsx)("div",{style:{overflowX:"auto",borderRadius:"12px"},children:(0,j.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",tableLayout:"fixed",backgroundColor:S},children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)(W,{columnKey:"blueprint_id",title:"Blueprint ID",currentSort:e,onSort:n,style:{width:"50%",paddingLeft:"24px"}}),(0,j.jsx)(W,{columnKey:"blueprint_category",title:"Category",currentSort:e,onSort:n,style:{width:"20%",textAlign:"center"}}),(0,j.jsx)(W,{columnKey:"total",title:"Downloads",currentSort:e,onSort:n,style:{width:"15%",textAlign:"right"}}),(0,j.jsx)(W,{columnKey:"last_downloaded",title:"Last Downloaded",currentSort:e,onSort:n,style:{width:"15%",textAlign:"right",paddingRight:"24px"}})]})}),(0,j.jsx)("tbody",{children:r.map((t,e)=>(0,j.jsxs)("tr",{style:e%2==0?{backgroundColor:C}:{backgroundColor:z},children:[(0,j.jsx)("td",{style:{padding:"12px 16px",paddingLeft:"24px",borderBottom:`1px solid ${B}`,fontSize:"14px",color:L,wordBreak:"break-all",overflowWrap:"break-word",whiteSpace:"normal"},children:(0,j.jsx)("a",{href:`https://github.com/my-repo/blueprints/blob/main/${t.blueprint_category}/${t.blueprint_id}.yaml`,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:t.blueprint_id})}),(0,j.jsx)("td",{style:{padding:"12px 16px",borderBottom:`1px solid ${B}`,fontSize:"14px",color:v,textAlign:"center"},children:(0,j.jsx)("span",{style:{display:"inline-block",padding:"4px 8px",borderRadius:"9999px",fontSize:"12px",fontWeight:"500",backgroundColor:"rgba(79, 70, 229, 0.2)",color:w},children:t.blueprint_category})}),(0,j.jsx)("td",{style:{padding:"12px 16px",borderBottom:`1px solid ${B}`,fontSize:"14px",color:v,textAlign:"right",fontFamily:"monospace"},children:A(parseInt(t.total,10))}),(0,j.jsx)("td",{style:{padding:"12px 16px",paddingRight:"24px",borderBottom:`1px solid ${B}`,fontSize:"14px",color:v,textAlign:"right"},children:t.last_downloaded?new Date(t.last_downloaded).toLocaleDateString():"N/A"})]},t.blueprint_id))})]})})},I={totalDownloads:1247,byCategory:[{blueprint_category:"controllers",total:"850"},{blueprint_category:"automations",total:"210"},{blueprint_category:"notifications",total:"187"}],topBlueprints:[{blueprint_category:"controllers",blueprint_id:"ikea_e2001_c2002",total:"150",last_downloaded:"2025-11-20"},{blueprint_category:"controllers",blueprint_id:"tuya_ZG-101Z-D",total:"120",last_downloaded:"2025-11-22"},{blueprint_category:"automations",blueprint_id:"presence_simulator",total:"90",last_downloaded:"2025-11-18"},{blueprint_category:"notifications",blueprint_id:"low_battery_alert",total:"80",last_downloaded:"2025-11-19"},{blueprint_category:"controllers",blueprint_id:"aqara_dj11lm",total:"75",last_downloaded:"2025-11-21"},{blueprint_category:"controllers",blueprint_id:"long_id_test_zha_or_z2m_device_controller_with_multiple_entities",total:"70",last_downloaded:"2025-11-15"}],daily:[{day:"2078-11-18",total:"50"},{day:"2078-11-19",total:"65"},{day:"2078-11-20",total:"80"},{day:"2078-11-21",total:"100"},{day:"2078-11-22",total:"110"},{day:"2078-11-23",total:"105"},{day:"2078-11-24",total:"120"}]},K=()=>{const[t,e]=(0,l.useState)(null),[o,_]=(0,l.useState)(!0),[C,z]=(0,l.useState)(null),L=(0,l.useCallback)(async()=>{_(!0);try{const t=await(async()=>new Promise(t=>{setTimeout(()=>{t(I)},1e3)}))();e(t)}catch(t){console.error("Failed to fetch metrics data:",t)}finally{_(!1)}},[]);(0,l.useEffect)(()=>{L()},[L]);const W=t?.totalDownloads||0,K=(0,l.useMemo)(()=>t?t.byCategory.map(t=>{const e=parseInt(t.total,10);return{name:t.blueprint_category,value:e,percent:e/W*100}}):[],[t,W]),R=(0,l.useMemo)(()=>t?t.daily.map(t=>({label:new Date(t.day).toLocaleDateString("en-US",{month:"short",day:"numeric"}),total:parseInt(t.total,10)})):[],[t]),F=(0,l.useMemo)(()=>t?t.topBlueprints.filter(t=>!C||t.blueprint_category===C).slice(0,10).map(t=>({id:t.blueprint_id,name:t.blueprint_id.replace(/_/g," "),Downloads:parseInt(t.total,10)})).sort((t,e)=>e.Downloads-t.Downloads):[],[t,C]),G=(0,l.useMemo)(()=>t?[...t.topBlueprints].sort((t,e)=>parseInt(e.total,10)-parseInt(t.total,10)):[],[t]),O=(0,l.useMemo)(()=>(0,b.A)(f.A),[]),U=(0,l.useMemo)(()=>({backgroundColor:S,borderRadius:"12px",padding:"24px",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.3)",marginBottom:"24px"}),[]),E=(0,l.useMemo)(()=>({...U,padding:"0",overflow:"hidden"}),[U]);return(0,j.jsx)(r.A,{title:"Metrics | Awesome HA Blueprints",description:"Download metrics for all blueprints",children:(0,j.jsxs)("main",{style:{padding:"32px",maxWidth:"1200px",margin:"0 auto",color:v,backgroundColor:k},children:[(0,j.jsx)("h1",{style:{fontSize:"32px",fontWeight:"800",marginBottom:"24px",color:v},children:"Blueprint Download Metrics"}),o||!t?(0,j.jsxs)("div",{style:{textAlign:"center",padding:"100px",color:D,fontSize:"18px"},children:[(0,j.jsx)("p",{children:"Loading metrics data from the backend..."}),(0,j.jsx)("div",{style:{display:"inline-block",width:"20px",height:"20px",border:`3px solid ${w}`,borderTopColor:"transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,j.jsx)("style",{children:"\n              @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n              }\n            "})]}):(0,j.jsxs)("div",{children:[(0,j.jsx)("section",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"24px",marginBottom:"24px"},children:[{title:"Total Downloads",value:A(t.totalDownloads),color:"linear-gradient(135deg, #4f46e5, #6366f1)"},{title:"Tracked Blueprints",value:A(t.topBlueprints.length),color:"linear-gradient(135deg, #10b981, #34d399)"},{title:"Total Categories",value:A(t.byCategory.length),color:"linear-gradient(135deg, #f59e0b, #fbbf24)"}].map(t=>(0,j.jsxs)("div",{style:{...U,padding:"20px",textAlign:"center",background:t.color,color:"#fff"},children:[(0,j.jsx)("p",{style:{fontSize:"14px",fontWeight:"500",opacity:.9,margin:"0 0 4px 0"},children:t.title}),(0,j.jsx)("p",{style:{fontSize:"32px",fontWeight:"bold",margin:0},children:t.value})]},t.title))}),(0,j.jsxs)("section",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"24px",marginBottom:"24px"},children:[(0,j.jsxs)("div",{style:U,children:[(0,j.jsx)("h2",{style:{fontSize:"20px",fontWeight:"600",borderBottom:`1px solid ${B}`,paddingBottom:"16px",marginBottom:"16px"},children:"Daily Downloads Trend"}),(0,j.jsx)("div",{style:{height:"300px"},children:(0,j.jsx)(a.u,{width:"100%",height:"100%",children:(0,j.jsxs)(m.Q,{data:R,children:[(0,j.jsx)(p.d,{strokeDasharray:"3 3",stroke:B}),(0,j.jsx)(g.W,{dataKey:"label",stroke:D,fontSize:12,tickLine:!1,axisLine:!1}),(0,j.jsx)(h.h,{stroke:D,fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:t=>A(t)}),(0,j.jsx)(i.m,{contentStyle:{backgroundColor:S,border:`1px solid ${B}`},labelStyle:{color:v},formatter:t=>[A(t),"Downloads"]}),(0,j.jsx)(c.Gk,{type:"monotone",dataKey:"total",stroke:w,fill:"url(#colorUv)",name:"Downloads",strokeWidth:2}),(0,j.jsx)("defs",{children:(0,j.jsxs)("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,j.jsx)("stop",{offset:"5%",stopColor:w,stopOpacity:.8}),(0,j.jsx)("stop",{offset:"95%",stopColor:w,stopOpacity:0})]})})]})})})]}),(0,j.jsxs)("div",{style:U,children:[(0,j.jsx)("h2",{style:{fontSize:"20px",fontWeight:"600",borderBottom:`1px solid ${B}`,paddingBottom:"16px",marginBottom:"16px"},children:"Category Distribution"}),(0,j.jsx)("div",{style:{height:"300px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,j.jsx)(a.u,{width:"100%",height:"100%",children:(0,j.jsxs)(u.r,{children:[(0,j.jsx)(d.F,{data:K,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,children:K.map((t,e)=>(0,j.jsx)(s.f,{fill:O(t.name),onClick:()=>z(C===t.name?null:t.name),style:{cursor:"pointer"}},`cell-${e}`))}),(0,j.jsx)(i.m,{content:(0,j.jsx)(T,{})}),(0,j.jsx)(n.s,{wrapperStyle:{fontSize:"12px",color:v}})]})})}),(0,j.jsx)("p",{style:{textAlign:"center",marginTop:"16px",color:D,fontSize:"14px"},children:C?`Showing Top 10 for: ${C}`:"Click a category to filter Top 10 chart below."})]})]}),(0,j.jsxs)("section",{style:U,children:[(0,j.jsxs)("h2",{style:{fontSize:"20px",fontWeight:"600",borderBottom:`1px solid ${B}`,paddingBottom:"16px",marginBottom:"16px"},children:["Top 10 Blueprints"," ",C?`(Filtered by: ${C})`:""]}),(0,j.jsx)("div",{style:{height:"350px"},children:F.length>0?(0,j.jsx)(a.u,{width:"100%",height:"100%",children:(0,j.jsxs)(y.E,{data:F,layout:"vertical",margin:{top:5,right:30,left:150,bottom:5},children:[(0,j.jsx)(p.d,{strokeDasharray:"3 3",stroke:B}),(0,j.jsx)(g.W,{type:"number",stroke:D,fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:t=>A(t)}),(0,j.jsx)(h.h,{dataKey:"name",type:"category",stroke:D,fontSize:12,tickLine:!1,axisLine:!1}),(0,j.jsx)(i.m,{content:(0,j.jsx)($,{})}),(0,j.jsx)(n.s,{iconType:"circle",wrapperStyle:{fontSize:"12px",color:v}}),(0,j.jsx)(x.y,{dataKey:"Downloads",name:"# of Downloads",fill:O(C||"top10"),barSize:20,radius:[0,4,4,0]})]})}):(0,j.jsx)("p",{style:{textAlign:"center",padding:"50px",color:D},children:"No top blueprints found for the current selection."})})]}),(0,j.jsx)("section",{style:E,children:(0,j.jsx)(M,{data:G})})]})]})})}}}]);