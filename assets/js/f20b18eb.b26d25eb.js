"use strict";(globalThis.webpackChunkawesome_ha_library_website=globalThis.webpackChunkawesome_ha_library_website||[]).push([[5447],{18256(e,t,r){r.r(t),r.d(t,{default:()=>k});var l=r(82128),o=r(36863),a=r(4037),i=r(32775),n=r(1188),s=r(17203),d=r(6588),c=r(19285),p=r(27428),x=r(97138),u=r(39332),y=r(2295),g=r(15068),b=r(76205),h=r(67869),m=r(41929),f=r(41778),L=r(95556),_=r(4784);let w=null;const j=()=>{if(w)return w;const e=(_.default?.customFields||{}).env||{},t=e.SUPABASE_URL||process.env.SUPABASE_URL,r=e.SUPABASE_ANON_KEY||process.env.SUPABASE_ANON_KEY;if(t&&r)try{w=(0,L.UU)(t,r)}catch(l){console.error("Supabase init failed",l)}return w};var A=r(77900);const S=e=>Number.isFinite(e)?e.toLocaleString():"0",v=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString(void 0,{timeZone:"UTC",year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid Date"}},C=(e,t)=>{const r=new Map;e.forEach(e=>{r.set(e.day,Number(e.total??0))});const l=[],o=new Date,a=new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()));for(let i=t-1;i>=0;i--){const e=new Date(a);e.setUTCDate(a.getUTCDate()-i);const t=e.toISOString().substring(0,10),o=r.get(t)??0;l.push({label:e.toLocaleDateString(void 0,{month:"short",day:"numeric",timeZone:"UTC"}),total:o})}return l},k=()=>{const[e,t]=(0,l.useState)({totalDownloads:0,byCategory:[],aggregates:[],daily:[]}),[r,L]=(0,l.useState)(!0),[_,w]=(0,l.useState)(!1),[k,B]=(0,l.useState)(void 0),[D,$]=(0,l.useState)(15),[T,P]=(0,l.useState)(10),[E,z]=(0,l.useState)("ALL"),[M,R]=(0,l.useState)("ALL"),[U,W]=(0,l.useState)("ALL"),[N,K]=(0,l.useState)("ALL"),[I,F]=(0,l.useState)({key:"total",direction:"desc"}),[O,Z]=(0,l.useState)(!1),Y=(0,m.A)(f.A),{totalDownloads:H,byCategory:V,aggregates:G,daily:q}=e;(0,l.useEffect)(()=>{const e=()=>{const e=document.documentElement.getAttribute("data-theme");Z("dark"===e)};e();const t=new MutationObserver(t=>{for(const r of t)"attributes"===r.type&&"data-theme"===r.attributeName&&e()});return t.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>t.disconnect()},[]);const Q={bg:O?"#1b1b1d":"#f9fafb",cardBg:O?"#242526":"#ffffff",textPrimary:O?"#e5e7eb":"#1f2937",textSecondary:O?"#9ca3af":"#6b7280",gridLine:O?"#444":"#e5e7eb",tooltipBg:O?"#242526":"#ffffff",tooltipBorder:O?"#444":"#ccc",tooltipText:O?"#e5e7eb":"#333",accentColor:"#4f46e5"},X={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"32px",width:"100%"},J={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"32px",width:"100%"};if("undefined"!=typeof window){window.matchMedia("(max-width: 768px)").matches&&(X.gridTemplateColumns="1fr",J.gridTemplateColumns="1fr")}const ee={backgroundColor:Q.cardBg,borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",overflow:"hidden",color:Q.textPrimary,minWidth:"0",border:O?"1px solid #333":"none"},te=e=>({backgroundColor:e,color:"white",padding:"12px",fontWeight:"bold",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.05em"}),re={padding:"16px",borderBottom:`1px solid ${Q.gridLine}`,margin:0,fontSize:"1.25rem",color:Q.textPrimary,fontWeight:"bold"},le=({active:e,payload:t,label:r})=>{if(e&&t&&t.length){const e=t.find(e=>"Downloads"===e.dataKey||"total"===e.dataKey),l=e?.value??t[0]?.value??0,o=t[0]?.payload?.name??t[0]?.payload?.id??r??"Value";return(0,A.jsxs)("div",{style:{padding:"10px",backgroundColor:Q.tooltipBg,border:`1px solid ${Q.tooltipBorder}`,borderRadius:"5px",color:Q.tooltipText},children:[(0,A.jsx)("p",{style:{fontWeight:"bold",marginBottom:"5px"},children:o}),(0,A.jsxs)("p",{children:["Downloads: ",S(l)]})]})}return null},oe=e=>{const{x:t,y:r,payload:l}=e;return(0,A.jsx)("g",{transform:`translate(${t},${r})`,children:(0,A.jsx)("text",{x:0,y:0,dy:5,textAnchor:"end",fill:Q.textSecondary,fontSize:10,title:l.value,children:l.value})})},ae=({current:e,onSelect:t,isDailyLoading:r})=>{const l=t=>({padding:"6px 12px",margin:"0 4px",borderRadius:"4px",cursor:r?"not-allowed":"pointer",fontWeight:"bold",backgroundColor:e===t?Q.accentColor:Q.cardBg,color:e===t?"white":Q.textPrimary,border:`1px solid ${e===t?Q.accentColor:Q.gridLine}`,transition:"all 0.2s",boxShadow:e===t?"0 2px 4px rgba(0,0,0,0.2)":"none",fontSize:"14px",opacity:r&&e!==t?.6:1});return(0,A.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"20px",paddingTop:"10px"},children:[1,7,15,30,90].map(e=>(0,A.jsxs)("button",{onClick:()=>t(e),style:l(e),disabled:r,children:[e,"D"]},e))})},ie=e=>{let t="desc";I.key===e&&"desc"===I.direction&&(t="asc"),F({key:e,direction:t})},ne=({sortKey:e})=>I.key!==e?(0,A.jsx)("span",{style:{fontSize:"0.7em",marginLeft:"5px",opacity:.4},dangerouslySetInnerHTML:{__html:"&#x25B2;&#x25BC;"}}):(0,A.jsx)("span",{style:{fontSize:"0.7em",marginLeft:"5px",color:Q.accentColor},dangerouslySetInnerHTML:{__html:"asc"===I.direction?"&#x25B2;":"&#x25BC;"}}),se=({data:e})=>(0,A.jsxs)("div",{style:{padding:"24px 16px 16px 16px"},children:[(0,A.jsx)("h3",{style:{fontSize:"1.25rem",color:Q.textPrimary,fontWeight:"bold",marginBottom:"15px",textAlign:"center"},children:Se}),(0,A.jsx)("div",{style:{overflowX:"auto"},children:(0,A.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",tableLayout:"fixed",fontSize:"14px",margin:"0"},children:[(0,A.jsxs)("colgroup",{children:[(0,A.jsx)("col",{style:{width:"auto"}}),(0,A.jsx)("col",{style:{width:"1%",whiteSpace:"nowrap"}}),(0,A.jsx)("col",{style:{width:"1%",whiteSpace:"nowrap"}}),(0,A.jsx)("col",{style:{width:"1%",whiteSpace:"nowrap"}}),(0,A.jsx)("col",{style:{width:"1%",whiteSpace:"nowrap"}}),(0,A.jsx)("col",{style:{width:"1%",whiteSpace:"nowrap"}})]}),(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{style:{backgroundColor:O?"#333":"#f3f4f6"},children:[(0,A.jsxs)("th",{onClick:()=>ie("id"),style:{padding:"12px 8px",textAlign:"left",cursor:"pointer",color:Q.textPrimary,borderBottom:`2px solid ${Q.accentColor}`},children:["Blueprint ID ",(0,A.jsx)(ne,{sortKey:"id"})]}),(0,A.jsxs)("th",{onClick:()=>ie("category"),style:{padding:"12px 8px",textAlign:"left",cursor:"pointer",color:Q.textPrimary,borderBottom:`2px solid ${Q.accentColor}`,whiteSpace:"nowrap"},children:["Category ",(0,A.jsx)(ne,{sortKey:"category"})]}),(0,A.jsxs)("th",{onClick:()=>ie("library"),style:{padding:"12px 8px",textAlign:"left",cursor:"pointer",color:Q.textPrimary,borderBottom:`2px solid ${Q.accentColor}`,whiteSpace:"nowrap"},children:["Library ",(0,A.jsx)(ne,{sortKey:"library"})]}),(0,A.jsxs)("th",{onClick:()=>ie("release"),style:{padding:"12px 8px",textAlign:"left",cursor:"pointer",color:Q.textPrimary,borderBottom:`2px solid ${Q.accentColor}`,whiteSpace:"nowrap"},children:["Release ",(0,A.jsx)(ne,{sortKey:"release"})]}),(0,A.jsxs)("th",{onClick:()=>ie("total"),style:{padding:"12px 8px",textAlign:"center",cursor:"pointer",color:Q.textPrimary,borderBottom:`2px solid ${Q.accentColor}`,whiteSpace:"nowrap"},children:["Downloads ",(0,A.jsx)(ne,{sortKey:"total"})]}),(0,A.jsxs)("th",{onClick:()=>ie("lastDownloaded"),style:{padding:"12px 8px",textAlign:"right",cursor:"pointer",color:Q.textPrimary,borderBottom:`2px solid ${Q.accentColor}`,whiteSpace:"nowrap"},children:["Last Downloaded ",(0,A.jsx)(ne,{sortKey:"lastDownloaded"})]})]})}),(0,A.jsx)("tbody",{children:e.map((e,t)=>(0,A.jsxs)("tr",{style:{borderBottom:`1px solid ${Q.gridLine}`,backgroundColor:t%2==0?Q.cardBg:O?"#2d2d2f":"#fcfcfc"},children:[(0,A.jsx)("td",{style:{padding:"10px 8px",wordBreak:"break-word",color:Q.textPrimary,textAlign:"left"},children:e.blueprint_id}),(0,A.jsx)("td",{style:{padding:"10px 8px",color:Y(e.blueprint_category),textAlign:"left",whiteSpace:"nowrap"},children:e.blueprint_category}),(0,A.jsx)("td",{style:{padding:"10px 8px",textAlign:"left",color:Q.textPrimary,whiteSpace:"nowrap"},children:e.blueprint_library??"\u2014"}),(0,A.jsx)("td",{style:{padding:"10px 8px",textAlign:"left",color:Q.textPrimary,whiteSpace:"nowrap"},children:e.blueprint_release??"-"}),(0,A.jsx)("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"bold",color:Q.textPrimary,whiteSpace:"nowrap"},children:S(e.total)}),(0,A.jsx)("td",{style:{padding:"10px 8px",textAlign:"right",color:Q.textPrimary,whiteSpace:"nowrap"},children:v(e.last_downloaded)})]},`${e.blueprint_category}:${e.blueprint_id}:${e.blueprint_library??"ALL"}:${e.blueprint_release??"ALL"}`))})]})}),0===e.length&&(0,A.jsx)("p",{style:{textAlign:"center",padding:"20px",color:Q.textSecondary},children:"No detailed data found for the current selection."})]}),de=(0,l.useMemo)(()=>"ALL"===E?"category":"ALL"===U?"blueprint":"ALL"===M?"library":"ALL"===N?"release":"detail",[E,U,M,N]),ce=(0,l.useMemo)(()=>{const e=new Set;return G.forEach(t=>e.add(t.blueprint_category)),Array.from(e).sort()},[G]),pe=(0,l.useMemo)(()=>{const e=new Set;return G.forEach(t=>{"ALL"!==E&&t.blueprint_category!==E||e.add(t.blueprint_id)}),Array.from(e).sort()},[G,E]),xe=(0,l.useMemo)(()=>{const e=new Set;return G.forEach(t=>{"ALL"!==E&&t.blueprint_category!==E||"ALL"!==U&&t.blueprint_id!==U||t.blueprint_library&&e.add(t.blueprint_library)}),Array.from(e).sort()},[G,E,U]),ue=(0,l.useMemo)(()=>{const e=new Set;return G.forEach(t=>{"ALL"!==E&&t.blueprint_category!==E||"ALL"!==U&&t.blueprint_id!==U||"ALL"!==M&&t.blueprint_library!==M||t.blueprint_release&&e.add(t.blueprint_release)}),Array.from(e).sort()},[G,E,U,M]),ye=(0,l.useMemo)(()=>V.map(e=>({name:e.blueprint_category,category:e.blueprint_category,value:e.total,total:e.total,label:e.blueprint_category})),[V]),ge=(0,l.useCallback)((e,t,r)=>{const l=new Map;return e.forEach(e=>{const o=t(e),a=l.get(o);a?(a.total+=e.total,e.last_downloaded&&(!a.last_downloaded||e.last_downloaded>a.last_downloaded)&&(a.last_downloaded=e.last_downloaded)):l.set(o,r(e))}),Array.from(l.values())},[]),be=(0,l.useMemo)(()=>G.filter(e=>("ALL"===E||e.blueprint_category===E)&&(("ALL"===U||e.blueprint_id===U)&&(("ALL"===M||e.blueprint_library===M)&&("ALL"===N||e.blueprint_release===N)))),[G,E,U,M,N]),he=(0,l.useMemo)(()=>"category"===de||"blueprint"===de?ge(be,e=>`${e.blueprint_category}::${e.blueprint_id}`,e=>({blueprint_category:e.blueprint_category,blueprint_id:e.blueprint_id,blueprint_library:null,blueprint_release:null,total:e.total,last_downloaded:e.last_downloaded})):"library"===de?ge(be,e=>`${e.blueprint_category}::${e.blueprint_id}::${e.blueprint_library??""}`,e=>({blueprint_category:e.blueprint_category,blueprint_id:e.blueprint_id,blueprint_library:e.blueprint_library,blueprint_release:null,total:e.total,last_downloaded:e.last_downloaded})):"release"===de?ge(be,e=>`${e.blueprint_category}::${e.blueprint_id}::${e.blueprint_library??""}::${e.blueprint_release??""}`,e=>({blueprint_category:e.blueprint_category,blueprint_id:e.blueprint_id,blueprint_library:e.blueprint_library,blueprint_release:e.blueprint_release,total:e.total,last_downloaded:e.last_downloaded})):be.map(e=>({blueprint_category:e.blueprint_category,blueprint_id:e.blueprint_id,blueprint_library:e.blueprint_library,blueprint_release:e.blueprint_release,total:e.total,last_downloaded:e.last_downloaded})),[ge,be,de]),me=(0,l.useMemo)(()=>{const e=[...he];return e.sort((e,t)=>{let r=0;const l=I.key;if("total"===l)r=e.total-t.total;else if("id"===l)r=e.blueprint_id.localeCompare(t.blueprint_id);else if("category"===l)r=e.blueprint_category.localeCompare(t.blueprint_category);else if("library"===l){const l=e.blueprint_library??"",o=t.blueprint_library??"";r=l.localeCompare(o)}else if("release"===l){const l=e.blueprint_release??"",o=t.blueprint_release??"";r=l.localeCompare(o)}else if("lastDownloaded"===l){r=(e.last_downloaded?new Date(e.last_downloaded).getTime():0)-(t.last_downloaded?new Date(t.last_downloaded).getTime():0)}return"asc"===I.direction?r:-r}),e},[he,I]),fe=(0,l.useMemo)(()=>me.slice(0,T).map(e=>({id:e.blueprint_id,name:e.blueprint_id.length>40?`${e.blueprint_id.substring(0,37)}...`:e.blueprint_id,Downloads:e.total})),[me,T]),Le=(0,l.useCallback)(()=>{z("ALL"),W("ALL"),R("ALL"),K("ALL")},[]),_e=(0,l.useCallback)(()=>{W("ALL"),R("ALL"),K("ALL")},[]),we=(0,l.useCallback)(()=>{R("ALL"),K("ALL")},[]),je=(0,l.useCallback)(()=>{K("ALL")},[]),Ae=()=>{Le()},Se=(0,l.useMemo)(()=>"category"===de?"Top Blueprints (all categories)":"blueprint"===de?`Top Blueprints (${E})`:"library"===de?`Libraries for ${U}`:"release"===de?`Releases for ${U} \u2192 ${M}`:`Release details: ${U} \u2192 ${M} \u2192 ${N}`,[de,E,U,M,N]),ve=(0,l.useMemo)(()=>{const e=[{label:"All Categories",onClick:Le}];return"ALL"!==E&&e.push({label:E,onClick:_e}),"ALL"!==U&&e.push({label:U,onClick:we}),"ALL"!==M&&e.push({label:M,onClick:je}),"ALL"!==N&&e.push({label:N,onClick:()=>{}}),e},[_e,Le,we,je,E,U,M,N]),Ce=(0,l.useCallback)(()=>{if("undefined"==typeof window)return!1;const e=window?.env||{};return Boolean(e.SUPABASE_URL&&e.SUPABASE_ANON_KEY)},[]);return(0,l.useEffect)(()=>{if("undefined"!=typeof window){if(!Ce()){const e=[{blueprint_category:"controllers",blueprint_id:"mock-ikea_e2001_e2002",blueprint_library:"EPMatt",blueprint_release:"awesome",total:1e4,last_downloaded:"2025-11-19T10:30:00Z"},{blueprint_category:"controllers",blueprint_id:"mock-ikea_e2001_e2002",blueprint_library:"yarafie",blueprint_release:"anything",total:5e3,last_downloaded:"2025-11-21T10:30:00Z"},{blueprint_category:"hooks",blueprint_id:"mock-light",blueprint_library:"EPMatt",blueprint_release:"awesome",total:5e3,last_downloaded:"2025-11-18T10:30:00Z"},{blueprint_category:"automations",blueprint_id:"mock-addon_update_notification",blueprint_library:"EPMatt",blueprint_release:"awesome",total:250,last_downloaded:"2025-11-22T10:30:00Z"}],r=e.reduce((e,t)=>e+t.total,0),l=new Map;e.forEach(e=>{l.set(e.blueprint_category,(l.get(e.blueprint_category)??0)+e.total)});const o=Array.from(l.entries()).map(([e,t])=>({blueprint_category:e,total:t}));return t(t=>({...t,totalDownloads:r,byCategory:o,aggregates:e})),B("Supabase variables missing. Showing mock aggregate data instead."),void L(!1)}(async()=>{try{const e=await(async e=>{const t=j();if(!t)throw new Error("Supabase Client not initialized (Check Env Vars)");const r={p_category:e.category||null,p_library:e.library||null,p_release:e.release||null,p_id:e.id||null},{data:l,error:o}=await t.rpc("get_library_downloads_aggregates",r);if(o)throw new Error(`RPC Error: ${o.message} (Details: ${o.details})`);return(l||[]).map(e=>({blueprint_category:e.blueprint_category,blueprint_library:e.blueprint_library,blueprint_release:e.blueprint_release,blueprint_id:e.blueprint_id,total:Number(e.total_downloads||0),last_downloaded:e.last_downloaded}))})({}),r=e.reduce((e,t)=>e+t.total,0),l=new Map;e.forEach(e=>{l.set(e.blueprint_category,(l.get(e.blueprint_category)??0)+e.total)});const o=Array.from(l.entries()).map(([e,t])=>({blueprint_category:e,total:t}));t(t=>({...t,totalDownloads:r,byCategory:o,aggregates:e})),B(void 0)}catch(e){B(`Failed to load aggregate metrics: ${e?.message||"Unknown error."}`)}finally{L(!1)}})()}},[Ce]),(0,l.useEffect)(()=>{if(r)return;if("undefined"==typeof window)return;if(!Ce()){const e=[{day:new Date(Date.now()-864e6).toISOString().substring(0,10),total:10},{day:new Date(Date.now()-432e6).toISOString().substring(0,10),total:20},{day:(new Date).toISOString().substring(0,10),total:22}],r=C(e,D);return t(e=>({...e,daily:r})),void w(!1)}w(!0);const e="ALL"===E?null:E,l="ALL"===U?null:U,o="ALL"===M?null:M,a="ALL"===N?null:N;(async()=>{try{const r=await(async e=>{const t=j();if(!t)throw new Error("Supabase Client not initialized");const r={p_days:e.days,p_category:e.category||null,p_library:e.library||null,p_release:e.release||null,p_id:e.id||null},{data:l,error:o}=await t.rpc("get_library_downloads_daily",r);return o?(console.error("RPC Error (Daily):",o),[]):(l||[]).map(e=>({day:e.day,total:Number(e.total||0)}))})({days:D,category:e,id:l,library:o,release:a}),i=C(r,D);t(e=>({...e,daily:i}))}catch(r){B(`Failed to load daily metrics: ${r?.message||"Unknown error."}`)}finally{w(!1)}})()},[Ce,r,D,E,U,M,N]),(0,A.jsx)(o.A,{title:"Library Downloads Metrics",description:"Enhanced metrics dashboard with library-aware analytics",children:(0,A.jsxs)("main",{className:"container margin-vert--lg",style:{backgroundColor:Q.bg,transition:"background-color 0.3s ease",minHeight:"100vh",padding:"2rem"},children:[(0,A.jsx)("h1",{style:{textAlign:"center",marginBottom:"32px",fontSize:"2rem",fontWeight:"bold",color:Q.textPrimary},children:"Library Download Metrics Dashboard"}),r&&(0,A.jsx)("div",{style:{textAlign:"center",color:Q.textPrimary},children:"Loading core metrics..."}),!r&&k&&(0,A.jsxs)("div",{className:"alert alert--danger",role:"alert",children:[(0,A.jsx)("h4",{className:"alert__heading",children:"Metrics Notice"}),(0,A.jsx)("p",{children:k})]}),!r&&(0,A.jsxs)("div",{style:{width:"100%"},children:[(0,A.jsxs)("section",{style:X,children:[(0,A.jsxs)("div",{style:ee,children:[(0,A.jsx)("div",{style:te(Q.accentColor),children:"Total Downloads"}),(0,A.jsx)("div",{style:{padding:"24px",textAlign:"center"},children:(0,A.jsx)("p",{style:{fontSize:"2.5rem",fontWeight:"900",color:Q.accentColor,margin:0},children:S(H)})})]}),(0,A.jsxs)("div",{style:ee,children:[(0,A.jsx)("div",{style:te("#9333ea"),children:"Tracked Blueprints (rows)"}),(0,A.jsx)("div",{style:{padding:"24px",textAlign:"center"},children:(0,A.jsx)("p",{style:{fontSize:"2.5rem",fontWeight:"900",color:"#9333ea",margin:0},children:S(G.length)})})]})]}),(0,A.jsxs)("section",{style:{...ee,marginBottom:"24px"},children:[(0,A.jsx)("div",{style:te("#0ea5e9"),children:"Library View - Selection"}),(0,A.jsxs)("div",{style:{padding:"16px"},children:[(0,A.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"},children:[ve.map((e,t)=>(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("button",{type:"button",onClick:e.onClick,style:{padding:"6px 10px",borderRadius:"6px",border:`1px solid ${Q.gridLine}`,background:Q.cardBg,color:Q.textPrimary,cursor:t===ve.length-1?"default":"pointer",opacity:t===ve.length-1?.9:1,fontWeight:t===ve.length-1?"bold":"normal"},disabled:t===ve.length-1,children:e.label}),t<ve.length-1&&(0,A.jsx)("span",{style:{color:Q.textSecondary},children:"\u203a"})]},e.label)),(0,A.jsx)("div",{style:{marginLeft:"auto",display:"flex",gap:"8px",flexWrap:"wrap"},children:(0,A.jsx)("button",{type:"button",onClick:Ae,style:{padding:"6px 10px",borderRadius:"6px",border:`1px solid ${Q.gridLine}`,background:O?"#2d2d2f":"#f3f4f6",color:Q.textPrimary,cursor:"pointer",fontWeight:"bold"},children:"Reset"})})]}),(0,A.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",gap:"12px",marginTop:"14px"},children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{style:{fontSize:"12px",color:Q.textSecondary,marginBottom:"6px"},children:"Category"}),(0,A.jsxs)("select",{value:E,onChange:e=>{const t=e.target.value;z(t),W("ALL"),R("ALL"),K("ALL")},style:{width:"100%",padding:"8px",borderRadius:"6px"},children:[(0,A.jsx)("option",{value:"ALL",children:"ALL"}),ce.map(e=>(0,A.jsx)("option",{value:e,children:e},e))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{style:{fontSize:"12px",color:Q.textSecondary,marginBottom:"6px"},children:"Blueprint"}),(0,A.jsxs)("select",{value:U,onChange:e=>{const t=e.target.value;W(t),R("ALL"),K("ALL")},style:{width:"100%",padding:"8px",borderRadius:"6px"},disabled:"ALL"===E,children:[(0,A.jsx)("option",{value:"ALL",children:"ALL"}),pe.map(e=>(0,A.jsx)("option",{value:e,children:e},e))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{style:{fontSize:"12px",color:Q.textSecondary,marginBottom:"6px"},children:"Library"}),(0,A.jsxs)("select",{value:M,onChange:e=>{const t=e.target.value;R(t),K("ALL")},style:{width:"100%",padding:"8px",borderRadius:"6px"},disabled:"ALL"===E||"ALL"===U,children:[(0,A.jsx)("option",{value:"ALL",children:"ALL"}),xe.map(e=>(0,A.jsx)("option",{value:e,children:e},e))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{style:{fontSize:"12px",color:Q.textSecondary,marginBottom:"6px"},children:"Release"}),(0,A.jsxs)("select",{value:N,onChange:e=>K(e.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px"},disabled:"ALL"===E||"ALL"===U||"ALL"===M,children:[(0,A.jsx)("option",{value:"ALL",children:"ALL"}),ue.map(e=>(0,A.jsx)("option",{value:e,children:e},e))]})]})]})]})]}),(0,A.jsxs)("section",{style:J,children:[(0,A.jsxs)("div",{style:ee,children:[(0,A.jsxs)("h3",{style:re,children:["Daily Downloads (Last ",D," Days)"]}),(0,A.jsx)(ae,{current:D,onSelect:$,isDailyLoading:_}),(0,A.jsxs)("div",{style:{height:"350px",padding:"10px",position:"relative"},children:[_&&(0,A.jsx)("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:O?"rgba(36, 37, 38, 0.8)":"rgba(255, 255, 255, 0.8)",zIndex:10,borderRadius:"4px",color:Q.textPrimary,fontSize:"1.2rem",fontWeight:"bold"},children:"Updating chart..."}),(0,A.jsx)(a.u,{width:"100%",height:"100%",children:(0,A.jsxs)(i.Q,{data:q,margin:{top:10,right:10,left:-10,bottom:0},children:[(0,A.jsx)("defs",{children:(0,A.jsxs)("linearGradient",{id:"colorTotal",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,A.jsx)("stop",{offset:"5%",stopColor:Q.accentColor,stopOpacity:.8}),(0,A.jsx)("stop",{offset:"95%",stopColor:Q.accentColor,stopOpacity:0})]})}),(0,A.jsx)(n.d,{strokeDasharray:"3 3",stroke:Q.gridLine,vertical:!1}),(0,A.jsx)(s.W,{dataKey:"label",stroke:Q.textSecondary,tick:{fontSize:10,fill:Q.textSecondary}}),(0,A.jsx)(d.h,{allowDecimals:!1,stroke:Q.textSecondary,tick:{fontSize:10,fill:Q.textSecondary},tickFormatter:S}),(0,A.jsx)(c.m,{content:(0,A.jsx)(le,{})}),(0,A.jsx)(p.Gk,{type:"monotone",dataKey:"total",stroke:Q.accentColor,strokeWidth:3,fill:"url(#colorTotal)"})]})})]})]}),(0,A.jsxs)("div",{style:ee,children:[(0,A.jsx)("h3",{style:re,children:"Category Distribution (Click to filter)"}),(0,A.jsx)("div",{style:{height:"350px",padding:"10px"},children:(0,A.jsx)(a.u,{width:"100%",height:"100%",children:(0,A.jsxs)(x.r,{children:[(0,A.jsx)(u.Fq,{data:ye,dataKey:"value",nameKey:"category",cx:"50%",cy:"50%",innerRadius:60,outerRadius:90,paddingAngle:3,fill:"#8884d8",labelLine:!1,label:({percent:e})=>`${(100*e).toFixed(0)}%`,onClick:e=>{const t=e?.category;t&&(z(e=>e===t?"ALL":t),W("ALL"),R("ALL"),K("ALL"))},style:{cursor:"pointer"},children:ye.map((e,t)=>(0,A.jsx)(y.f,{fill:Y(e.category),stroke:O?"#242526":"#fff",opacity:"ALL"===E||E===e.category?1:.4},`cell-${t}`))}),(0,A.jsx)(c.m,{content:(0,A.jsx)(le,{})}),(0,A.jsx)(g.s,{iconType:"circle",wrapperStyle:{fontSize:"12px",color:Q.textPrimary}})]})})})]})]}),(0,A.jsxs)("section",{style:{...ee,paddingBottom:"20px",marginBottom:"32px"},children:[(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px",borderBottom:`1px solid ${Q.gridLine}`,flexWrap:"wrap",gap:"8px"},children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1,minWidth:0},children:[(0,A.jsx)("h3",{style:{...re,borderBottom:"none",paddingLeft:0,margin:0},children:"ALL"===E?`Top ${T} Blueprints (All Categories)`:"ALL"!==M?`Top ${T} Controller Blueprints (${M})`:`Top ${T} ${E.charAt(0).toUpperCase()+E.slice(1)} Blueprints`}),xe.length>0&&(0,A.jsxs)("div",{style:{margin:"8px 0 8px 0"},children:[(0,A.jsx)("label",{style:{fontSize:"0.85rem",marginRight:"8px",color:Q.textSecondary},children:"Library:"}),(0,A.jsxs)("select",{value:M,onChange:e=>R(e.target.value),style:{padding:"4px 8px",fontSize:"0.85rem",borderRadius:"4px",border:`1px solid ${Q.gridLine}`,background:"var(--ifm-navbar-background-color)",color:"var(--ifm-font-color-base)"},children:[(0,A.jsx)("option",{value:"ALL",children:"All Libraries"}),xe.map(e=>(0,A.jsx)("option",{value:e,children:e},e))]})]})]}),(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,A.jsxs)("div",{style:{position:"relative"},children:[(0,A.jsx)("select",{value:T,onChange:e=>P(Number(e.target.value)),style:{appearance:"none",padding:"6px 32px 6px 10px",fontSize:"14px",cursor:"pointer",backgroundColor:"var(--ifm-navbar-background-color)",color:"var(--ifm-font-color-base)",border:"1px solid var(--ifm-color-emphasis-300)",borderRadius:"6px"},children:[5,10,15,20,25,30,40,50].map(e=>(0,A.jsxs)("option",{value:e,children:["Top ",e]},e))}),(0,A.jsx)("svg",{style:{position:"absolute",right:"10px",top:"50%",width:"14px",height:"14px",transform:"translateY(-50%)",opacity:.7,pointerEvents:"none"},viewBox:"0 0 24 24",children:(0,A.jsx)("path",{fill:"currentColor",d:"M7 10l5 5 5-5z"})})]}),("ALL"!==E||"ALL"!==M)&&(0,A.jsx)("button",{onClick:Ae,style:{fontSize:"12px",padding:"6px 10px",borderRadius:"4px",backgroundColor:"#ef4444",color:"white",border:"none",cursor:"pointer",fontWeight:"bold",transition:"background-color 0.2s",whiteSpace:"nowrap"},title:"Clear category/library filters",children:"Clear Filters"})]})]}),(0,A.jsx)("div",{style:{height:Math.max(400,40*fe.length)},children:fe.length>0?(0,A.jsx)(a.u,{width:"100%",height:"100%",children:(0,A.jsxs)(b.E,{onClick:e=>{const t=e?.id;if(t){if("ALL"===E){const e=G.find(e=>e.blueprint_id===t);e&&z(e.blueprint_category)}W(t),R("ALL"),K("ALL")}},data:fe,layout:"vertical",margin:{top:5,right:30,left:100,bottom:5},children:[(0,A.jsx)(n.d,{strokeDasharray:"3 3",horizontal:!1,stroke:Q.gridLine}),(0,A.jsx)(s.W,{type:"number",stroke:Q.textSecondary,tick:{fontSize:10,fill:Q.textSecondary},tickFormatter:S,domain:[0,"auto"],allowDecimals:!1}),(0,A.jsx)(d.h,{dataKey:"name",type:"category",width:100,tickLine:!1,axisLine:!1,tick:(0,A.jsx)(oe,{})}),(0,A.jsx)(c.m,{content:(0,A.jsx)(le,{})}),(0,A.jsx)(g.s,{iconType:"circle",wrapperStyle:{fontSize:"12px",color:Q.textPrimary}}),(0,A.jsx)(h.yP,{dataKey:"Downloads",name:"# of Downloads",fill:Y("ALL"!==M?M:"ALL"===E?"top-all":E),barSize:20,radius:[0,4,4,0]})]})}):(0,A.jsx)("p",{style:{textAlign:"center",padding:"50px",color:Q.textSecondary},children:"No top blueprints found for the current selection."})})]}),(0,A.jsx)("section",{style:{...ee,overflow:"visible"},children:(0,A.jsx)(se,{data:me})})]})]})})}}}]);