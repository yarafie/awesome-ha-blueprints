"use strict";(globalThis.webpackChunkawesome_ha_library_website=globalThis.webpackChunkawesome_ha_library_website||[]).push([[8069],{23970(e,r,n){n.d(r,{Dk:()=>s,PG:()=>d});var o=n(95556),t=n(4784);let i=null;const l=()=>{if(i)return i;const e=(t.default?.customFields||{}).env||{},r="undefined"!=typeof window&&window.env||{},n=e.SUPABASE_URL||r.SUPABASE_URL,o=e.SUPABASE_ANON_KEY||r.SUPABASE_ANON_KEY;return n&&o&&a({supabaseUrl:n,supabaseKey:o}),i},a=({supabaseUrl:e,supabaseKey:r})=>{i=(0,o.UU)(e,r),console.log("\u2705  [Supabase] initialized")},s=async(e,r,n,o,t)=>{const i=l();if(!i)return console.error("\u274c  [Supabase] recordBlueprintDownload: client not initialized"),!1;try{const{error:l}=await i.from("library_downloads").insert([{blueprint_category:e,blueprint_id:r,blueprint_library:n,blueprint_release:o,blueprint_version:t,download_date:(new Date).toISOString()}]);return!l||(console.error("\u274c  [Supabase] Error recording library download:",l),!1)}catch(a){return console.error("\u274c  [Supabase] Exception recording library download:",a),!1}},d=async(e,r,n=null,o=null,t=null)=>{const i=l();if(!i)return console.error("\u274c  [Supabase] getBlueprintDownloads: client not initialized"),0;try{const{data:l,error:a}=await i.rpc("get_library_downloads",{p_category:e,p_id:r,p_library:n,p_release:o,p_version:t});return a?(console.error("\u274c  [Supabase] Error in getBlueprintDownloads RPC:",a),0):"number"==typeof l?l:Number(l??0)}catch(a){return console.error("\u274c  [Supabase] Exception in getBlueprintDownloads:",a),0}}},36739(e,r,n){n.r(r),n.d(r,{default:()=>d});var o=n(82128),t=n(18581),i=n(89361),l=n(12512),a=n(23970),s=n(77900);function d(e){const r=e.route.category,n=e.route.id,{consent:d}=(0,i.S)(),c=e=>{try{const r="my.home-assistant.io";new URL(e).hostname===r?window.location.href=e:console.error("\u274c Unsafe redirect blocked:",e)}catch{console.error("\u274c Invalid redirect URL:",e)}},u=(()=>{if("undefined"!=typeof window){const e=new URLSearchParams(window.location.search).get("version");if(e&&e.trim().length>0)return e}return e.route.version&&e.route.version.trim().length>0?e.route.version:"latest"})(),w=(()=>{if("undefined"!=typeof window){const r=new URLSearchParams(window.location.search).get("library");return r&&r.trim().length>0?r:e.route.library_id||null}return e.route.library_id||null})(),p=(()=>{if("undefined"!=typeof window){const r=new URLSearchParams(window.location.search).get("release");return r&&r.trim().length>0?r:e.route.release_id||null}return e.route.release_id||null})();let b=w,h=p;const y=e.route.releasesIndex||{};b||1!==Object.keys(y).length||(b=Object.keys(y)[0]),b&&!h&&y[b]&&1===Object.keys(y[b]).length&&(h=Object.keys(y[b])[0]);let f=u;if(b&&h&&"latest"===f&&y?.[b]?.[h]?.length){f=[...y[b][h]].sort((e,r)=>r.localeCompare(e))[0]}const _="https://my.home-assistant.io/redirect/blueprint_import/?blueprint_url="+encodeURIComponent(`https://raw.githubusercontent.com/yarafie/awesome-ha-blueprints/main/website/docs/blueprints/${r}/${n}/${`${b}/${h}/${f}/${n}.yaml`}`),g=f;return(0,o.useEffect)(()=>{if("undefined"!=typeof window){if(window.__blueprintDownloadHandled)return;window.__blueprintDownloadHandled=!0}if(!(r&&n&&b&&h&&g))return console.error("\u274c Invalid blueprint download record \u2014 aborting insert"),void c(_);d&&(0,l.sx)("blueprint","download",`${r}/${n}/${b}/${h}/${g}`,void 0),(0,a.Dk)(r,n,b,h,g).catch(e=>{console.error("\u274c Error recording blueprint download:",e)}).finally(()=>{c(_)})},[d,r,n,b,h,g,_]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.A,{children:(0,s.jsxs)("title",{children:["Download ",r,"/",n,b?`/${b}`:"",h?`/${h}`:"",f?`/${f}`:""]})}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"50vh",fontSize:"20px"},children:[(0,s.jsx)("h1",{children:"Thanks for downloading!"}),(0,s.jsx)("p",{children:"Redirecting to your Home Assistant instance..."})]})]})}}}]);