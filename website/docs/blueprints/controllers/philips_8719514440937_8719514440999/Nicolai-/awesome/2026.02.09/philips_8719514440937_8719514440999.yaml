# Blueprint metadata
blueprint:
  name: Controller - Philips 8719514440937/8719514440999 Hue Tap dial switch
  description: |
    # Controller - Philips 8719514440937/8719514440999 Hue Tap dial switch

    â„¹ï¸ Version 2026.02.09

    Controller automation for executing any kind of action triggered by the provided Philips Hue Tap dial switch (models 8719514440937 / 8719514440999).

    Supports Zigbee2MQTT.

    Automations created with this blueprint can be connected with one or more [Hooks](https://yarafie.github.io/awesome-ha-blueprints/docs/blueprints/hooks) supported by this controller.
    Hooks allow to easily create controller-based automations for interacting with lights, covers, media players, and potentially more.

    See the list of [Hooks available for this controller](https://yarafie.github.io/awesome-ha-blueprints/docs/blueprints/controllers/philips_8719514440937_8719514440999/Nicolai-/awesome/2026.02.09#available-hooks) for additional details.

    A small note, avoid using both custom actions and Hooks in the same blueprint, otherwise strange things may occur.

    ## More Info

    ðŸ“ [Changelog](https://yarafie.github.io/awesome-ha-blueprints/docs/blueprints/controllers/philips_8719514440937_8719514440999/Nicolai-/awesome/2026.02.09#changelog)
    ðŸ“• Full documentation regarding this blueprint is available [here](https://yarafie.github.io/awesome-ha-blueprints/docs/blueprints/controllers/philips_8719514440937_8719514440999).

    ðŸš€ This blueprint is part of the **[Awesome HA Blueprints](https://yarafie.github.io/awesome-ha-blueprints) project**. Please consider **[leaving a star on GitHub](https://github.com/Nicolai-/awesome-ha-blueprints)**! ðŸŒŸ

  source_url: https://github.com/yarafie/awesome-ha-blueprints/blob/main/blueprints/controllers/philips_8719514440937_8719514440999/Nicolai-/awesome/2026.02.09/philips_8719514440937_8719514440999.yaml
  domain: automation
  homeassistant:
    min_version: 2024.10.0
  # Device Selector
  input:
    controller_device:
      name: (Required) (Zigbee2MQTT) Controller Device
      description: The controller device to use for the automation. Choose a value only if the remote is integrated with Zigbee2MQTT.
      default: ''
      selector:
        # source: https://www.zigbee2mqtt.io/devices/8719514440937_8719514440999.html
        device:
          filter:
            - integration: mqtt
              manufacturer: Philips
              model: Hue Tap dial switch
            # For backwards compatibility with z2m 1.x. model_id is added to end of model rather than a seperate attribute in z2m 2.x
            - integration: mqtt
              manufacturer: Philips
              model: Hue Tap dial switch (8719514440937/8719514440999)
          multiple: false
    # inputs for custom actions
    action_button_1_short:
      name: (Optional) Button 1 short press
      description: Action to run on short button 1 press.
      default: []
      selector:
        action:
    action_button_1_long:
      name: (Optional) Button 1 long press
      description: Action to run on long button 1 press.
      default: []
      selector:
        action:
    action_button_1_release:
      name: (Optional) Button 1 release
      description: Action to run on button 1 release after a long press.
      default: []
      selector:
        action:
    action_button_2_short:
      name: (Optional) Button 2 short press
      description: Action to run on short button 2 press.
      default: []
      selector:
        action:
    action_button_2_long:
      name: (Optional) Button 2 long press
      description: Action to run on long button 2 press.
      default: []
      selector:
        action:
    action_button_2_release:
      name: (Optional) Button 2 release
      description: Action to run on button 2 release after a long press.
      default: []
      selector:
        action:
    action_button_3_short:
      name: (Optional) Button 3 short press
      description: Action to run on short button 3 press.
      default: []
      selector:
        action:
    action_button_3_long:
      name: (Optional) Button 3 long press
      description: Action to run on long button 3 press.
      default: []
      selector:
        action:
    action_button_3_release:
      name: (Optional) Button 3 release
      description: Action to run on button 3 release after a long press.
      default: []
      selector:
        action:
    action_button_4_short:
      name: (Optional) Button 4 short press
      description: Action to run on short button 4 press.
      default: []
      selector:
        action:
    action_button_4_long:
      name: (Optional) Button 4 long press
      description: Action to run on long button 4 press.
      default: []
      selector:
        action:
    action_button_4_release:
      name: (Optional) Button 4 release
      description: Action to run on button 4 release after a long press.
      default: []
      selector:
        action:
    action_brightness_step_up:
      name: (Optional) Brightness step up
      description: Action to run when the dial reports a brightness step up.
      default: []
      selector:
        action:
    action_brightness_step_down:
      name: (Optional) Brightness step down
      description: Action to run when the dial reports a brightness step down.
      default: []
      selector:
        action:
    # inputs for looping custom actions on long button press events until the corresponding release event is received
    long_press_options_section:
      name: Long Press options
      icon: mdi:remote
      collapsed: true
      input:
        button_1_long_loop:
          name: (Optional) Button 1 long press - loop until release
          description: Loop the button 1 action until the button is released.
          default: false
          selector:
            boolean:
        button_1_long_max_loop_repeats:
          name: (Optional) Button 1 long press - Maximum loop repeats
          description: >-
            Maximum number of repeats for the custom action, when looping is enabled.
            Use it as a safety limit to prevent an endless loop in case the corresponding stop event is not received.
          default: 20
          selector:
            number:
              min: 1.0
              max: 1000.0
              mode: slider
              step: 1.0
        button_2_long_loop:
          name: (Optional) Button 2 long press - loop until release
          description: Loop the button 2 action until the button is released.
          default: false
          selector:
            boolean:
        button_2_long_max_loop_repeats:
          name: (Optional) Button 2 long press - Maximum loop repeats
          description: >-
            Maximum number of repeats for the custom action, when looping is enabled.
            Use it as a safety limit to prevent an endless loop in case the corresponding stop event is not received.
          default: 20
          selector:
            number:
              min: 1.0
              max: 1000.0
              mode: slider
              step: 1.0
        button_3_long_loop:
          name: (Optional) Button 3 long press - loop until release
          description: Loop the button 3 action until the button is released.
          default: false
          selector:
            boolean:
        button_3_long_max_loop_repeats:
          name: (Optional) Button 3 long press - Maximum loop repeats
          description: >-
            Maximum number of repeats for the custom action, when looping is enabled.
            Use it as a safety limit to prevent an endless loop in case the corresponding stop event is not received.
          default: 20
          selector:
            number:
              min: 1.0
              max: 1000.0
              mode: slider
              step: 1.0
        button_4_long_loop:
          name: (Optional) Button 4 long press - loop until release
          description: Loop the button 4 action until the button is released.
          default: false
          selector:
            boolean:
        button_4_long_max_loop_repeats:
          name: (Optional) Button 4 long press - Maximum loop repeats
          description: >-
            Maximum number of repeats for the custom action, when looping is enabled.
            Use it as a safety limit to prevent an endless loop in case the corresponding stop event is not received.
          default: 20
          selector:
            number:
              min: 1.0
              max: 1000.0
              mode: slider
              step: 1.0
        helper_long_press_delay:
          name: (Optional) Helper - Long Press delay
          description: Max delay between the pushing and releasing of a button long press event. Increase this value if you notice that the long press action is not triggered properly.
          default: 250
          selector:
            number:
              min: 100.0
              max: 5000.0
              unit_of_measurement: milliseconds
              mode: box
              step: 10.0
# ... rest of file not shown ...
#
# Automation schema
variables:
  # Controller ID
  controller_id: !input controller_device
  # integration id used to select items in the action mapping
  # integration type is set from trigger.id
  integration_id: '{{ trigger.id.split("-")[0] }}'
  # convert input tags to variables, to be used in templates
  button_1_long_loop: !input button_1_long_loop
  button_1_long_max_loop_repeats: !input button_1_long_max_loop_repeats
  button_2_long_loop: !input button_2_long_loop
  button_2_long_max_loop_repeats: !input button_2_long_max_loop_repeats
  button_3_long_loop: !input button_3_long_loop
  button_3_long_max_loop_repeats: !input button_3_long_max_loop_repeats
  button_4_long_loop: !input button_4_long_loop
  button_4_long_max_loop_repeats: !input button_4_long_max_loop_repeats
  helper_long_press_delay: !input helper_long_press_delay
  # mapping between actions and integrations
  actions_mapping:
    z2m:
      # source: https://www.zigbee2mqtt.io/devices/8719514440937_8719514440999.html
      button_1_short: [button_1_press]
      button_1_long: [button_1_hold]
      button_1_release: [button_1_hold_release]
      button_2_short: [button_2_press]
      button_2_long: [button_2_hold]
      button_2_release: [button_2_hold_release]
      button_3_short: [button_3_press]
      button_3_long: [button_3_hold]
      button_3_release: [button_3_hold_release]
      button_4_short: [button_4_press]
      button_4_long: [button_4_hold]
      button_4_release: [button_4_hold_release]
      brightness_step_up: [brightness_step_up]
      brightness_step_down: [brightness_step_down]
  # pre-choose actions for buttons based on configured integration
  # mainly used to pass to hooks through ahb_controller_event
  button_1_short: '{{ actions_mapping[integration_id]["button_1_short"] }}'
  button_1_long: '{{ actions_mapping[integration_id]["button_1_long"] }}'
  button_1_release: '{{ actions_mapping[integration_id]["button_1_release"] }}'
  button_2_short: '{{ actions_mapping[integration_id]["button_2_short"] }}'
  button_2_long: '{{ actions_mapping[integration_id]["button_2_long"] }}'
  button_2_release: '{{ actions_mapping[integration_id]["button_2_release"] }}'
  button_3_short: '{{ actions_mapping[integration_id]["button_3_short"] }}'
  button_3_long: '{{ actions_mapping[integration_id]["button_3_long"] }}'
  button_3_release: '{{ actions_mapping[integration_id]["button_3_release"] }}'
  button_4_short: '{{ actions_mapping[integration_id]["button_4_short"] }}'
  button_4_long: '{{ actions_mapping[integration_id]["button_4_long"] }}'
  button_4_release: '{{ actions_mapping[integration_id]["button_4_release"] }}'
  brightness_step_up: '{{ actions_mapping[integration_id]["brightness_step_up"] }}'
  brightness_step_down: '{{ actions_mapping[integration_id]["brightness_step_down"] }}'
#
# Mode Block
mode: single
max_exceeded: silent
#
# Triggers Block
triggers:
  # triggers for zigbee2mqtt
  - trigger: device
    id: z2m-button-1-short
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_1_press
  - trigger: device
    id: z2m-button-1-long
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_1_hold
  - trigger: device
    id: z2m-button-1-hold-release
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_1_hold_release
  - trigger: device
    id: z2m-button-2-short
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_2_press
  - trigger: device
    id: z2m-button-2-long
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_2_hold
  - trigger: device
    id: z2m-button-2-hold-release
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_2_hold_release
  - trigger: device
    id: z2m-button-3-short
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_3_press
  - trigger: device
    id: z2m-button-3-long
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_3_hold
  - trigger: device
    id: z2m-button-3-hold-release
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_3_hold_release
  - trigger: device
    id: z2m-button-4-short
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_4_press
  - trigger: device
    id: z2m-button-4-long
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_4_hold
  - trigger: device
    id: z2m-button-4-hold-release
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: button_4_hold_release
  - trigger: device
    id: z2m-dial-brightness-step-up
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: brightness_step_up
  - trigger: device
    id: z2m-dial-brightness-step-down
    domain: mqtt
    device_id: !input controller_device
    type: action
    subtype: brightness_step_down
#
# Conditions Block
conditions:
  - condition: and
    conditions:
      # check that the button event is not empty
      - >-
        {%- set trigger_action -%}
        {%- if integration_id == "z2m" -%}
        {{ trigger.payload }}
        {%- endif -%}
        {%- endset -%}
        {{ trigger_action not in ["","None","unknown"] }}
#
# Actions Block
actions:
  - choose:
      # Button 1 short press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-1-short
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_1_short
          - choose:
              - conditions: []
                sequence: !input action_button_1_short
      # Button 1 long press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-1-long
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_1_long
          - choose:
              - conditions: []
                sequence: !input action_button_1_long
          - choose:
              - conditions: '{{ button_1_long_loop }}'
                sequence:
                  - repeat:
                      count: !input button_1_long_max_loop_repeats
                      sequence:
                        - parallel:
                            - sequence: !input action_button_1_long
                            - sequence:
                                - choose:
                                    - conditions: []
                                      sequence:
                                        - wait_for_trigger:
                                            - trigger: device
                                              domain: mqtt
                                              device_id: !input controller_device
                                              type: action
                                              subtype: button_1_hold_release
                                          timeout:
                                            milliseconds: !input helper_long_press_delay
                                          continue_on_timeout: true
                                        - if:
                                            - condition: template
                                              value_template: '{{ wait.trigger.idx is defined }}'
                                          then:
                                            - event: ahb_controller_event
                                              event_data:
                                                controller: '{{ controller_id }}'
                                                action: button_1_release
                                            - choose:
                                                - conditions: []
                                                  sequence: !input action_button_1_release
                                            - stop: button_1_released
      # Button 1 release
      - conditions:
          - condition: trigger
            id:
              - z2m-button-1-hold-release
              - z2m-button-1-press-release
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_1_release
          - choose:
              - conditions: []
                sequence: !input action_button_1_release
      # Button 2 short press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-2-short
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_2_short
          - choose:
              - conditions: []
                sequence: !input action_button_2_short
      # Button 2 long press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-2-long
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_2_long
          - choose:
              - conditions: []
                sequence: !input action_button_2_long
          - choose:
              - conditions: '{{ button_2_long_loop }}'
                sequence:
                  - repeat:
                      count: !input button_2_long_max_loop_repeats
                      sequence:
                        - parallel:
                            - sequence: !input action_button_2_long
                            - sequence:
                                - choose:
                                    - conditions: []
                                      sequence:
                                        - wait_for_trigger:
                                            - trigger: device
                                              domain: mqtt
                                              device_id: !input controller_device
                                              type: action
                                              subtype: button_2_hold_release
                                          timeout:
                                            milliseconds: !input helper_long_press_delay
                                          continue_on_timeout: true
                                        - if:
                                            - condition: template
                                              value_template: '{{ wait.trigger.idx is defined }}'
                                          then:
                                            - event: ahb_controller_event
                                              event_data:
                                                controller: '{{ controller_id }}'
                                                action: button_2_release
                                            - choose:
                                                - conditions: []
                                                  sequence: !input action_button_2_release
                                            - stop: button_2_released
      # Button 2 release
      - conditions:
          - condition: trigger
            id:
              - z2m-button-2-hold-release
              - z2m-button-2-press-release
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_2_release
          - choose:
              - conditions: []
                sequence: !input action_button_2_release
      # Button 3 short press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-3-short
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_3_short
          - choose:
              - conditions: []
                sequence: !input action_button_3_short
      # Button 3 long press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-3-long
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_3_long
          - choose:
              - conditions: []
                sequence: !input action_button_3_long
          - choose:
              - conditions: '{{ button_3_long_loop }}'
                sequence:
                  - repeat:
                      count: !input button_3_long_max_loop_repeats
                      sequence:
                        - parallel:
                            - sequence: !input action_button_3_long
                            - sequence:
                                - choose:
                                    - conditions: []
                                      sequence:
                                        - wait_for_trigger:
                                            - trigger: device
                                              domain: mqtt
                                              device_id: !input controller_device
                                              type: action
                                              subtype: button_3_hold_release
                                          timeout:
                                            milliseconds: !input helper_long_press_delay
                                          continue_on_timeout: true
                                        - if:
                                            - condition: template
                                              value_template: '{{ wait.trigger.idx is defined }}'
                                          then:
                                            - event: ahb_controller_event
                                              event_data:
                                                controller: '{{ controller_id }}'
                                                action: button_3_release
                                            - choose:
                                                - conditions: []
                                                  sequence: !input action_button_3_release
                                            - stop: button_3_released
      # Button 3 release
      - conditions:
          - condition: trigger
            id:
              - z2m-button-3-hold-release
              - z2m-button-3-press-release
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_3_release
          - choose:
              - conditions: []
                sequence: !input action_button_3_release
      # Button 4 short press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-4-short
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_4_short
          - choose:
              - conditions: []
                sequence: !input action_button_4_short
      # Button 4 long press
      - conditions:
          - condition: trigger
            id:
              - z2m-button-4-long
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_4_long
          - choose:
              - conditions: []
                sequence: !input action_button_4_long
          - choose:
              - conditions: '{{ button_4_long_loop }}'
                sequence:
                  - repeat:
                      count: !input button_4_long_max_loop_repeats
                      sequence:
                        - parallel:
                            - sequence: !input action_button_4_long
                            - sequence:
                                - choose:
                                    - conditions: []
                                      sequence:
                                        - wait_for_trigger:
                                            - trigger: device
                                              domain: mqtt
                                              device_id: !input controller_device
                                              type: action
                                              subtype: button_4_hold_release
                                          timeout:
                                            milliseconds: !input helper_long_press_delay
                                          continue_on_timeout: true
                                        - if:
                                            - condition: template
                                              value_template: '{{ wait.trigger.idx is defined }}'
                                          then:
                                            - event: ahb_controller_event
                                              event_data:
                                                controller: '{{ controller_id }}'
                                                action: button_4_release
                                            - choose:
                                                - conditions: []
                                                  sequence: !input action_button_4_release
                                            - stop: button_4_released
      # Button 4 release
      - conditions:
          - condition: trigger
            id:
              - z2m-button-4-hold-release
              - z2m-button-4-press-release
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: button_4_release
          - choose:
              - conditions: []
                sequence: !input action_button_4_release
      # Brightness step up
      - conditions:
          - condition: trigger
            id:
              - z2m-dial-brightness-step-up
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: brightness_up
          - choose:
              - conditions: []
                sequence: !input action_brightness_step_up
      # Brightness step down
      - conditions:
          - condition: trigger
            id:
              - z2m-dial-brightness-step-down
        sequence:
          - event: ahb_controller_event
            event_data:
              controller: '{{ controller_id }}'
              action: brightness_down
          - choose:
              - conditions: []
                sequence: !input action_brightness_step_down
